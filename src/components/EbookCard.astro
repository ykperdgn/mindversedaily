---
import AmazonButton from './AmazonButton.astro';
const { ebook, compact = false } = Astro.props;
const { data } = ebook;
const coverWebp = data.cover?.endsWith('.jpg') ? data.cover.replace(/\.jpg$/, '.webp') : undefined;
---
<article class={`card${compact ? ' compact' : ''}`}>
  {data.cover && (
    <picture>
      {coverWebp && <source srcset={coverWebp} type="image/webp" />}
      <img src={data.cover} alt={data.title} loading="lazy" width="900" height="1200" />
    </picture>
  )}
  <div class="body">
    <h3>{data.title}</h3>
    <p class="desc">{data.description}</p>
    {!compact && <AmazonButton href={data.amazonUrl} label="Read on Kindle" />}
  </div>
</article>
<style>
.card{display:flex;flex-direction:column;background:rgba(255,255,255,0.04);border:1px solid rgba(255,255,255,0.08);border-radius:1rem;overflow:hidden;position:relative;min-height:240px;}
.card picture,.card img{width:100%;aspect-ratio:3/4;display:block;}
.card img{object-fit:cover;}
.body{padding:.85rem .9rem 1.1rem;display:flex;flex-direction:column;gap:.5rem;}
h3{margin:0;font-size:1rem;line-height:1.25;font-weight:600;}
.desc{margin:0;font-size:.75rem;line-height:1.35;opacity:.75;}
.card.compact{min-height:auto;}
.card.compact .body{padding:.85rem .9rem 1.1rem;gap:.5rem;}
.card.compact h3{font-size:1rem;}
.card.compact .desc{font-size:.75rem;}
</style>
