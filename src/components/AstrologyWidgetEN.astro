---
// English Astrology Widget - Horoscope and astrology features
interface Props {
  className?: string;
}

const { className = '' } = Astro.props;
---

<div class={`astrology-widget ${className}`}>
  <!-- Zodiac Selector -->
  <div class="zodiac-selector">
    <h3>üîÆ Your Daily Horoscope</h3>
    <div class="zodiac-grid">
      <button class="zodiac-sign" data-sign="aries">‚ôà Aries</button>
      <button class="zodiac-sign" data-sign="taurus">‚ôâ Taurus</button>
      <button class="zodiac-sign" data-sign="gemini">‚ôä Gemini</button>
      <button class="zodiac-sign" data-sign="cancer">‚ôã Cancer</button>
      <button class="zodiac-sign" data-sign="leo">‚ôå Leo</button>
      <button class="zodiac-sign" data-sign="virgo">‚ôç Virgo</button>
      <button class="zodiac-sign" data-sign="libra">‚ôé Libra</button>
      <button class="zodiac-sign" data-sign="scorpio">‚ôè Scorpio</button>
      <button class="zodiac-sign" data-sign="sagittarius">‚ôê Sagittarius</button>
      <button class="zodiac-sign" data-sign="capricorn">‚ôë Capricorn</button>
      <button class="zodiac-sign" data-sign="aquarius">‚ôí Aquarius</button>
      <button class="zodiac-sign" data-sign="pisces">‚ôì Pisces</button>
    </div>
  </div>

  <!-- Horoscope Result Area -->
  <div class="horoscope-result" id="horoscope-result-en" style="display: none;">
    <div class="result-header">
      <h4 id="selected-sign-name-en"></h4>
      <div class="result-tabs">
        <button class="tab-btn-en active" data-type="daily">Daily</button>
        <button class="tab-btn-en" data-type="weekly">Weekly</button>
        <button class="tab-btn-en" data-type="monthly">Monthly</button>
      </div>
    </div>
    <div class="result-content" id="result-content-en">
      <div class="loading">
        <div class="spinner"></div>
        <p>Reading the stars...</p>
      </div>
    </div>
  </div>

  <!-- Love Compatibility Section -->
  <div class="compatibility-section">
    <h3>üíï Love Compatibility</h3>
    <div class="compatibility-form">
      <select id="sign1-en" class="sign-select">
        <option value="">First Sign</option>
        <option value="aries">‚ôà Aries</option>
        <option value="taurus">‚ôâ Taurus</option>
        <option value="gemini">‚ôä Gemini</option>
        <option value="cancer">‚ôã Cancer</option>
        <option value="leo">‚ôå Leo</option>
        <option value="virgo">‚ôç Virgo</option>
        <option value="libra">‚ôé Libra</option>
        <option value="scorpio">‚ôè Scorpio</option>
        <option value="sagittarius">‚ôê Sagittarius</option>
        <option value="capricorn">‚ôë Capricorn</option>
        <option value="aquarius">‚ôí Aquarius</option>
        <option value="pisces">‚ôì Pisces</option>
      </select>

      <span class="compatibility-heart">üíù</span>

      <select id="sign2-en" class="sign-select">
        <option value="">Second Sign</option>
        <option value="aries">‚ôà Aries</option>
        <option value="taurus">‚ôâ Taurus</option>
        <option value="gemini">‚ôä Gemini</option>
        <option value="cancer">‚ôã Cancer</option>
        <option value="leo">‚ôå Leo</option>
        <option value="virgo">‚ôç Virgo</option>
        <option value="libra">‚ôé Libra</option>
        <option value="scorpio">‚ôè Scorpio</option>
        <option value="sagittarius">‚ôê Sagittarius</option>
        <option value="capricorn">‚ôë Capricorn</option>
        <option value="aquarius">‚ôí Aquarius</option>
        <option value="pisces">‚ôì Pisces</option>
      </select>

      <button id="check-compatibility-en" class="compatibility-btn" disabled>
        Check Compatibility
      </button>
    </div>

    <div class="compatibility-result" id="compatibility-result-en" style="display: none;">
      <div class="compatibility-score">
        <div class="score-circle">
          <span id="compatibility-score-en">0</span>
          <small>/10</small>
        </div>
      </div>
      <div class="compatibility-content" id="compatibility-content-en">
        <div class="loading">
          <div class="spinner"></div>
          <p>Stars calculating compatibility...</p>
        </div>
      </div>
    </div>
  </div>

  <!-- Cosmic Forecast -->
  <div class="cosmic-forecast">
    <h3>üåå This Week's Cosmic Energy</h3>
    <div class="cosmic-content" id="cosmic-content-en">
      <div class="loading">
        <div class="spinner"></div>
        <p>Listening to the universe...</p>
      </div>
    </div>
    <button id="refresh-cosmic-en" class="cosmic-refresh-btn">üîÑ Refresh</button>
  </div>
</div>

<style>
.astrology-widget {
  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
  border-radius: 20px;
  padding: 2rem;
  color: white;
  margin: 2rem 0;
  box-shadow: 0 10px 30px rgba(0,0,0,0.3);
}

.astrology-widget h3 {
  text-align: center;
  margin-bottom: 1.5rem;
  font-size: 1.5rem;
  text-shadow: 0 2px 4px rgba(0,0,0,0.3);
}

.zodiac-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
  gap: 0.5rem;
  margin-bottom: 2rem;
}

.zodiac-sign {
  background: rgba(255,255,255,0.2);
  border: 2px solid rgba(255,255,255,0.3);
  border-radius: 12px;
  padding: 0.8rem 0.5rem;
  color: white;
  font-size: 0.9rem;
  cursor: pointer;
  transition: all 0.3s ease;
  backdrop-filter: blur(10px);
}

.zodiac-sign:hover {
  background: rgba(255,255,255,0.3);
  border-color: rgba(255,255,255,0.5);
  transform: translateY(-2px);
}

.zodiac-sign.selected {
  background: rgba(255,215,0,0.3);
  border-color: #ffd700;
  box-shadow: 0 0 20px rgba(255,215,0,0.4);
}

.horoscope-result {
  background: rgba(255,255,255,0.1);
  border-radius: 15px;
  padding: 1.5rem;
  margin: 1.5rem 0;
  backdrop-filter: blur(10px);
}

.result-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 1rem;
  flex-wrap: wrap;
  gap: 1rem;
}

.result-tabs {
  display: flex;
  gap: 0.5rem;
}

.tab-btn-en {
  background: rgba(255,255,255,0.2);
  border: 1px solid rgba(255,255,255,0.3);
  border-radius: 8px;
  padding: 0.5rem 1rem;
  color: white;
  font-size: 0.9rem;
  cursor: pointer;
  transition: all 0.3s ease;
}

.tab-btn-en.active {
  background: rgba(255,215,0,0.3);
  border-color: #ffd700;
}

.result-content {
  background: rgba(0,0,0,0.2);
  border-radius: 10px;
  padding: 1.5rem;
  min-height: 200px;
}

.compatibility-section {
  background: rgba(255,255,255,0.1);
  border-radius: 15px;
  padding: 1.5rem;
  margin: 2rem 0;
  backdrop-filter: blur(10px);
}

.compatibility-form {
  display: flex;
  align-items: center;
  gap: 1rem;
  margin-bottom: 1.5rem;
  flex-wrap: wrap;
  justify-content: center;
}

.sign-select {
  background: rgba(255,255,255,0.2);
  border: 1px solid rgba(255,255,255,0.3);
  border-radius: 8px;
  padding: 0.5rem;
  color: white;
  min-width: 150px;
}

.sign-select option {
  background: #333;
  color: white;
}

.compatibility-heart {
  font-size: 1.5rem;
  animation: pulse 2s infinite;
}

.compatibility-btn {
  background: linear-gradient(45deg, #ff6b6b, #ee5a24);
  border: none;
  border-radius: 8px;
  padding: 0.7rem 1.2rem;
  color: white;
  font-weight: bold;
  cursor: pointer;
  transition: all 0.3s ease;
}

.compatibility-btn:hover:not(:disabled) {
  transform: translateY(-2px);
  box-shadow: 0 5px 15px rgba(0,0,0,0.3);
}

.compatibility-btn:disabled {
  opacity: 0.5;
  cursor: not-allowed;
}

.compatibility-result {
  display: flex;
  gap: 2rem;
  align-items: flex-start;
  flex-wrap: wrap;
}

.compatibility-score {
  text-align: center;
  flex-shrink: 0;
}

.compatibility-content {
  flex: 1;
  min-width: 300px;
  background: rgba(255,255,255,0.1);
  border-radius: 10px;
  padding: 1rem;
}

.score-circle {
  background: conic-gradient(from 0deg, #ff6b6b 0%, #feca57 50%, #48ca61 100%);
  border-radius: 50%;
  width: 80px;
  height: 80px;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  font-size: 1.5rem;
  font-weight: bold;
  margin: 0 auto;
}

.cosmic-forecast {
  background: rgba(0,0,0,0.2);
  border-radius: 15px;
  padding: 1.5rem;
  margin-top: 2rem;
}

.cosmic-content {
  background: rgba(255,255,255,0.1);
  border-radius: 10px;
  padding: 1.5rem;
  margin-bottom: 1rem;
  min-height: 150px;
}

.cosmic-refresh-btn {
  background: linear-gradient(45deg, #a8edea, #fed6e3);
  border: none;
  border-radius: 8px;
  padding: 0.5rem 1rem;
  color: #333;
  font-weight: bold;
  cursor: pointer;
  transition: all 0.3s ease;
  width: 100%;
}

.loading {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  height: 100%;
  min-height: 100px;
}

.spinner {
  width: 40px;
  height: 40px;
  border: 4px solid rgba(255,255,255,0.3);
  border-top: 4px solid #ffd700;
  border-radius: 50%;
  animation: spin 1s linear infinite;
  margin-bottom: 1rem;
}

@keyframes spin {
  0% { transform: rotate(0deg); }
  100% { transform: rotate(360deg); }
}

@keyframes pulse {
  0%, 100% { transform: scale(1); }
  50% { transform: scale(1.1); }
}

@media (max-width: 768px) {
  .astrology-widget {
    padding: 1rem;
  }

  .zodiac-grid {
    grid-template-columns: repeat(auto-fit, minmax(100px, 1fr));
  }

  .compatibility-form {
    flex-direction: column;
    align-items: stretch;
  }

  .sign-select {
    min-width: auto;
  }

  .compatibility-result {
    flex-direction: column;
    text-align: center;
  }
}
</style>

<script>
// English Astrology Widget JavaScript
document.addEventListener('DOMContentLoaded', function() {
  const zodiacSigns = document.querySelectorAll('.zodiac-sign');
  const horoscopeResult = document.getElementById('horoscope-result-en');
  const resultContent = document.getElementById('result-content-en');
  const selectedSignName = document.getElementById('selected-sign-name-en');
  const tabBtns = document.querySelectorAll('.tab-btn-en');  const compatibilityBtn = document.getElementById('check-compatibility-en');
  const sign1Select = document.getElementById('sign1-en');
  const sign2Select = document.getElementById('sign2-en');
  const compatibilityResult = document.getElementById('compatibility-result-en');
  const compatibilityContent = document.getElementById('compatibility-content-en');
  const cosmicContent = document.getElementById('cosmic-content-en');
  const refreshCosmicBtn = document.getElementById('refresh-cosmic-en');

  let currentSign = '';
  let currentType = 'daily';

  // Sign mapping from Turkish to English
  const signMapping = {
    'aries': 'koc',
    'taurus': 'boga',
    'gemini': 'ikizler',
    'cancer': 'yengec',
    'leo': 'aslan',
    'virgo': 'basak',
    'libra': 'terazi',
    'scorpio': 'akrep',
    'sagittarius': 'yay',
    'capricorn': 'oglak',
    'aquarius': 'kova',
    'pisces': 'balik'
  };

  const reverseSignMapping = Object.fromEntries(
    Object.entries(signMapping).map(([en, tr]) => [tr, en])
  );

  // Zodiac sign selection
  zodiacSigns.forEach(sign => {
    sign.addEventListener('click', function() {
      // Clear previous selection
      zodiacSigns.forEach(s => s.classList.remove('selected'));

      // Mark new selection
      this.classList.add('selected');
      currentSign = this.dataset.sign;

      // Show sign name
      const signName = this.textContent;
      selectedSignName.textContent = signName;

      // Show result area
      horoscopeResult.style.display = 'block';

      // Load horoscope
      loadHoroscope(currentSign, currentType);
    });
  });

  // Tab switching
  tabBtns.forEach(tab => {
    tab.addEventListener('click', function() {
      if (!currentSign) return;

      // Update tab state
      tabBtns.forEach(t => t.classList.remove('active'));
      this.classList.add('active');

      currentType = this.dataset.type;
      loadHoroscope(currentSign, currentType);
    });
  });

  // English Horoscope loading function
  async function loadHoroscope(sign, type) {
    showLoading(resultContent);

    // Convert English sign to Turkish for data lookup
    const turkishSign = signMapping[sign];

    // English horoscope content
    const englishHoroscopes = {
      'aries': {
        'daily': '‚ôà **Aries Daily Reading - July 1st**\n\nüî• Mars energy fills your day! Morning news could mark an important turning point in your life.\n\n**‚è∞ Hourly Guide:**\n‚Ä¢ **09:00-12:00** - Perfect time for job interviews\n‚Ä¢ **14:00-16:00** - Focus on creative projects\n‚Ä¢ **19:00-21:00** - Social activities and meeting friends\n\n**üí∞ Money:** Unexpected income is coming. Avoid big expenses.\n**üíï Love:** You might receive a romantic message from an old friend.\n**üè• Health:** High energy level, stay hydrated.',
        'weekly': '‚ôà **Aries Weekly Astro Guide (July 1-7)**\n\nüåü This week you\'re experiencing one of the most critical periods of personal transformation. Mercury-Mars conjunction supports brave decisions.\n\n**üìÖ Daily Breakdown:**\n‚Ä¢ **Monday-Tuesday:** Foundation setting for new projects\n‚Ä¢ **Wednesday-Thursday:** Golden days for communication, important meetings\n‚Ä¢ **Friday:** Be careful with finances, postpone big decisions\n‚Ä¢ **Weekend:** Family time and personal development\n\n**üéØ This Week\'s Goal:** Take action on long-delayed plans.',
        'monthly': '‚ôà **Aries July 2025 Monthly Astrology Calendar**\n\nüöÄ July is a month of great awakening and change for you! Sun-Jupiter trine supports career advancement.\n\n**üóìÔ∏è Important Dates:**\n‚Ä¢ **July 5-8:** Surprise developments in love life\n‚Ä¢ **July 12-15:** Career opportunities at peak\n‚Ä¢ **July 20-23:** Financial improvement trend\n‚Ä¢ **July 28-31:** Travel and new experiences\n\n**üíº Career:** Get ready for promotion! Don\'t refuse offers from upper management.\n**üíñ Relationships:** Commitment time is approaching.'
      },
      'taurus': {
        'daily': '‚ôâ **Taurus Daily Astro Energy**\n\nüå± Venus\'s powerful influence puts your aesthetic taste at its peak! Today\'s decisions could affect your long-term happiness.\n\n**üé® Creativity Time:**\nYour artistic talents are shining today. Focus on decoration, music, or cooking.\n\n**üíö Health Notes:**\n‚Ä¢ Pay attention to your neck and shoulder area\n‚Ä¢ Consume natural foods, avoid processed foods\n‚Ä¢ Yoga or meditation is ideal\n\n**üíù Relationships:** Spend quality time with your partner. If single, stay away from social media.',
        'weekly': '‚ôâ **Taurus 7-Day Astro Planning**\n\nüå∏ This week your search for stability is starting to pay off. Time to make practical decisions with strong earth element.\n\n**üíº Work Life:**\nReview your long-term projects. Don\'t expect quick results, patience is your key.\n\n**üí∞ Money Situation:**\n‚Ä¢ Revise your savings plans\n‚Ä¢ Research real estate investment\n‚Ä¢ Be careful with online shopping\n\n**üåø Nature Connection:** Definitely spend time among greenery this weekend.',
        'monthly': '‚ôâ **Taurus July Major Transformation**\n\nüèóÔ∏è This month you\'re rebuilding the foundations of your life. Everything you build with patience will be permanent.\n\n**üéØ Main Theme:** Financial security and emotional stability\n\n**üìä Monthly Goals:**\n1. **Financial Planning:** Open retirement or investment fund\n2. **Health:** Organize your eating habits\n3. **Relationships:** Strengthen long-term commitments\n4. **Career:** Develop your expertise area'
      },
      'gemini': {
        'daily': '‚ôä **Gemini Daily Brain Game**\n\nüß† With Mercury\'s strong influence, your mental activity is at its peak! Information you gather today will be very useful in the future.\n\n**üì± Communication Focus:**\n‚Ä¢ Get in touch with old friends\n‚Ä¢ Be active on social media but careful when sharing\n‚Ä¢ Watch podcasts or educational videos\n\n**üéì Learning Opportunities:**\nA new skill you learn today could be a turning point in your career path.\n\n**üí´ Luck Factor:** Unexpected opportunities in short-distance travel\n**‚ö†Ô∏è Warning:** Talking too much...',
        'weekly': '‚ôä **Gemini Communication Week**\n\nüìû This week is a golden opportunity to expand your network! You\'ll meet new people and renew old connections.\n\n**üóìÔ∏è Weekly Roadmap:**\n‚Ä¢ **Monday:** Brainstorming sessions\n‚Ä¢ **Tuesday-Wednesday:** Correspondence and meetings\n‚Ä¢ **Thursday:** Education or seminar participation\n‚Ä¢ **Friday:** Social activities\n‚Ä¢ **Weekend:** Mental detox\n\n**üìö Skill Development:** Ideal week to start learning a new language\n**üíª Technology:** You\'ll discover a new app or tool',
        'monthly': '‚ôä **Gemini July Information & Connection Month**\n\nüåê July is a big networking and learning period for you. Your versatile talents are starting to shine.\n\n**üéØ Monthly Objectives:**\n1. **Skill Upgrade:** Complete an online course\n2. **Network Expansion:** Meet 3 new people each week\n3. **Content Creation:** Produce blog or social media content\n4. **Travel Planning:** Plan short getaways\n\n**üìà Development Areas:**\n‚Ä¢ **Digital Marketing:** Promote yourself online'
      }
    };

    // Generate dynamic content for other signs
    const generateEnglishContent = (sign, type) => {
      const signNames = {
        'cancer': 'Cancer ‚ôã', 'leo': 'Leo ‚ôå', 'virgo': 'Virgo ‚ôç',
        'libra': 'Libra ‚ôé', 'scorpio': 'Scorpio ‚ôè', 'sagittarius': 'Sagittarius ‚ôê',
        'capricorn': 'Capricorn ‚ôë', 'aquarius': 'Aquarius ‚ôí', 'pisces': 'Pisces ‚ôì'
      };

      const periods = {
        'daily': 'Daily',
        'weekly': 'Weekly',
        'monthly': 'Monthly'
      };

      const advices = {
        'daily': [
          'Trust your intuition today, you\'re on the right path.',
          'You might be at the door of a new opportunity.',
          'Patience and determination are today\'s keywords.',
          'Be careful in communication, you might be misunderstood.',
          'Your energy level is high, focus on your goals.'
        ],
        'weekly': [
          'Focus on your personal development this week.',
          'Try to balance your relationships.',
          'Be cautious with financial matters.',
          'Ideal week for creative projects.',
          'Prioritize your health, don\'t neglect rest.'
        ],
        'monthly': [
          'Get ready for big changes this month.',
          'Review your long-term plans.',
          'New friendships and collaborations await you.',
          'Make peace with the past, look to the future with hope.',
          'Time to invest in yourself.'
        ]
      };

      const randomAdvice = advices[type][Math.floor(Math.random() * advices[type].length)];

      return `‚ú® **${signNames[sign]} ${periods[type]} Reading**\n\n${randomAdvice}\n\nüîÆ **Main Theme:** Transformation and renewal\nüí´ **Advice:** Listen to your inner voice\n‚≠ê **Luck:** Above average\n\n*For detailed readings, check our special articles in the horoscope section.*`;
    };

    setTimeout(() => {
      let content;
      if (englishHoroscopes[sign] && englishHoroscopes[sign][type]) {
        content = englishHoroscopes[sign][type];
      } else {
        content = generateEnglishContent(sign, type);
      }

      resultContent.innerHTML = `
        <div class="horoscope-content">
          ${content.replace(/\n/g, '<br>')}
        </div>
      `;
    }, 1000);
  }

  // Love compatibility check
  function checkCompatibilityInputs() {
    const sign1 = sign1Select.value;
    const sign2 = sign2Select.value;
    compatibilityBtn.disabled = !sign1 || !sign2;
  }

  sign1Select.addEventListener('change', checkCompatibilityInputs);
  sign2Select.addEventListener('change', checkCompatibilityInputs);

  compatibilityBtn.addEventListener('click', async function() {
    const sign1 = sign1Select.value;
    const sign2 = sign2Select.value;    if (!sign1 || !sign2) return;

    showLoading(compatibilityContent);
    compatibilityResult.style.display = 'block';

    // English compatibility analysis
    const generateEnglishCompatibility = (s1, s2) => {
      const signDetails = {
        'aries': { name: 'Aries', element: 'Fire', planet: 'Mars', traits: ['energetic', 'leader', 'impulsive'] },
        'taurus': { name: 'Taurus', element: 'Earth', planet: 'Venus', traits: ['patient', 'reliable', 'stubborn'] },
        'gemini': { name: 'Gemini', element: 'Air', planet: 'Mercury', traits: ['flexible', 'talkative', 'curious'] },
        'cancer': { name: 'Cancer', element: 'Water', planet: 'Moon', traits: ['emotional', 'protective', 'intuitive'] },
        'leo': { name: 'Leo', element: 'Fire', planet: 'Sun', traits: ['proud', 'creative', 'generous'] },
        'virgo': { name: 'Virgo', element: 'Earth', planet: 'Mercury', traits: ['detail-oriented', 'practical', 'perfectionist'] },
        'libra': { name: 'Libra', element: 'Air', planet: 'Venus', traits: ['balanced', 'diplomatic', 'indecisive'] },
        'scorpio': { name: 'Scorpio', element: 'Water', planet: 'Mars', traits: ['passionate', 'mysterious', 'strong'] },
        'sagittarius': { name: 'Sagittarius', element: 'Fire', planet: 'Jupiter', traits: ['free', 'optimistic', 'adventurous'] },
        'capricorn': { name: 'Capricorn', element: 'Earth', planet: 'Saturn', traits: ['disciplined', 'ambitious', 'responsible'] },
        'aquarius': { name: 'Aquarius', element: 'Air', planet: 'Uranus', traits: ['independent', 'innovative', 'eccentric'] },
        'pisces': { name: 'Pisces', element: 'Water', planet: 'Neptune', traits: ['dreamy', 'compassionate', 'sensitive'] }
      };

      const elementCompatibility = {
        'Fire': { 'Fire': 8, 'Earth': 4, 'Air': 9, 'Water': 3 },
        'Earth': { 'Fire': 4, 'Earth': 7, 'Air': 5, 'Water': 8 },
        'Air': { 'Fire': 9, 'Earth': 5, 'Air': 7, 'Water': 6 },
        'Water': { 'Fire': 3, 'Earth': 8, 'Air': 6, 'Water': 9 }
      };

      const info1 = signDetails[s1];
      const info2 = signDetails[s2];

      let baseScore = elementCompatibility[info1.element][info2.element];

      if (s1 === s2) {
        baseScore = 9;
      }

      if (info1.planet === info2.planet) {
        baseScore += 1;
      }

      const finalScore = Math.min(10, Math.max(1, baseScore + Math.floor(Math.random() * 2 - 1)));

      const levelMessages = {
        9: [
          "üî• **Perfect Match!** The stars are dancing for you! This pairing is truly rare and precious.",
          "‚ú® **Cosmic Connection!** Your souls vibrate on the same frequency. This is a miracle match!"
        ],
        8: [
          "üíñ **Great Compatibility!** You have a strong bond that complements each other.",
          "üåü **Strong Chemistry!** Natural attraction thanks to your element harmony."
        ],
        7: [
          "üíï **Good Match!** You can achieve great results with small efforts.",
          "‚≠ê **Promising!** Your differences make you stronger."
        ],
        6: [
          "üíõ **Moderate Compatibility.** You can build a beautiful relationship with patience and understanding.",
          "üåà **Balance Needed.** Magic happens when you try to understand each other!"
        ],
        5: [
          "üíô **Challenging Match.** You need each other for growth.",
          "üîÆ **Learning Relationship.** There are challenges but you grow stronger together."
        ]
      };

      const score = Math.max(5, finalScore);
      const messageKey = score >= 9 ? 9 : score >= 8 ? 8 : score >= 7 ? 7 : score >= 6 ? 6 : 5;
      const messages = levelMessages[messageKey];
      const selectedMessage = messages[Math.floor(Math.random() * messages.length)];

      const detailedAnalysis = `
**üé≠ Personality Analysis:**
‚Ä¢ **${info1.name}:** ${info1.traits.join(', ')}
‚Ä¢ **${info2.name}:** ${info2.traits.join(', ')}

**üåü Element Compatibility:** ${info1.element} + ${info2.element}
**ü™ê Planetary Influence:** ${info1.planet} & ${info2.planet}

**üí° Relationship Tips:**
${s1 === s2 ?
  '‚Ä¢ Being the same sign provides deep understanding\n‚Ä¢ Avoid ego conflicts\n‚Ä¢ Respect each other\'s space' :
  '‚Ä¢ See your differences as strengths\n‚Ä¢ Pay attention to communication\n‚Ä¢ Be open to learning from each other'
}

**üéØ Focus Areas for This Relationship:**
‚Ä¢ Mutual respect and understanding
‚Ä¢ Setting common goals
‚Ä¢ Discovering complementary qualities
      `;

      return {
        score: score,
        content: `üíï **${info1.name} & ${info2.name} Love Compatibility Report** üíï\n\n${selectedMessage}\n\n**üìä Compatibility Score: ${score}/10**\n\n${detailedAnalysis}`
      };
    };

    setTimeout(() => {
      const compatibility = generateEnglishCompatibility(sign1, sign2);
      document.getElementById('compatibility-score-en').textContent = compatibility.score;
      document.getElementById('compatibility-content-en').innerHTML = compatibility.content.replace(/\n/g, '<br>');
    }, 800);
  });

  // English cosmic forecast loading
  async function loadCosmicForecast() {
    showLoading(cosmicContent);

    const cosmicMessages = [
      'üåå **Cosmic Energy Report**\n\nMercury is coming out of retrograde this week. Be careful in communication.\n\n‚≠ê **Main Theme:** Renewal\nüîÆ **Advice:** Meditate\nüí´ **Opportunity:** Creative projects',
      'üåü **Universal Vibrations**\n\nVenus and Mars are in harmony. Love and passion together.\n\nüíï **Relationships:** Strengthening period\nüé® **Art:** Inspiring days\nüåô **Intuition:** Strong messages',
      '‚ú® **Astral Energy Status**\n\nWith Jupiter\'s positive influence, it\'s time for growth and expansion.\n\nüéØ **Goals:** Dream big\nüìö **Learning:** New knowledge\nüåç **Travel:** Distant places are calling'
    ];

    setTimeout(() => {
      const randomMessage = cosmicMessages[Math.floor(Math.random() * cosmicMessages.length)];
      cosmicContent.innerHTML = `
        <div class="cosmic-forecast-content">
          ${randomMessage.replace(/\n/g, '<br>')}
        </div>
      `;
    }, 1000);
  }

  refreshCosmicBtn.addEventListener('click', loadCosmicForecast);

  // Loading display function
  function showLoading(element) {
    element.innerHTML = `
      <div class="loading">
        <div class="spinner"></div>
        <p>Reading the stars...</p>
      </div>
    `;
  }

  // Load cosmic forecast on page load
  loadCosmicForecast();

  // Global functions
  window.loadHoroscopeEN = loadHoroscope;
});
</script>
